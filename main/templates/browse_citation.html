{% extends "base.html" %}

{% load relaton %}

{% block title %}{{ block.super }} — {{ ref }}{% endblock %}


{% block content %}
  <header class="">
    {% include "relaton/doc_ids.html" with ids=data.docid ref=ref %}
    <h2 class="fw3 f3 measure-wide">
      {% include "relaton/first_title.html" with title=data.title %}
    </h2>
  </header>

  <div class="cf">
    <div class="fl w-100 w-50-ns">
      <dl class="lh-title pv2 mt0">
        {% include "meta_row.html" with key="edition" val=data.edition|default:"—" %}
        {% if data.date %}
          {% include "meta_row.html" with key=data.date.type val=data.date.value %}
        {% endif %}
        {% include "meta_row.html" with key="revdate" val=data.revdate %}
        {% for c in data.contributor|as_list %}
          {% with c.organization.name as org and c.person.name.surname.content as surname and c.person.name.forename.content as forename %}
            {% if surname or forename %}  
              {% with forename|add:" "|add:surname as name %}
                {% include "meta_row.html" with key=c.role val=name %}
              {% endwith %}
            {% else %}
              {% include "meta_row.html" with key=c.role val=org %}
            {% endif %}
          {% endwith %}
        {% endfor %}
        {% include "meta_row.html" with key="place" val=data.place %}
      </dl>
    </div>

    <div class="fl w-100 w-50-ns">
      <dl class="lh-title pv2 mt0">
        {% include "meta_row.html" with key="doctype" val=data.doctype %}
        {% include "meta_row.html" with key="language" val=data.language|default:"—" %}
        {% include "meta_row.html" with key=data.link.type val=data.link.content %}
        {% for title in data.title|as_list %}
          {% include "meta_row.html" with key=title.type|stringformat:"s (title)" val=title.content %}
        {% endfor %}
      </dl>
    </div>
  </div>

  {% include "citation_dl.html" with dataset_id=dataset_id ref=ref %}

  <p class="gray f7">
    Available using API: {% url "api_get_ref" dataset_id ref %}
  </p>
{% endblock %}
